<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CFB 25 Coach Points Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(180deg, #111827 0%, #1f2937 100%);
            color: #e2e8f0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 1rem;
            overflow-x: hidden;
        }
        .container {
            background-color: #2d3748;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 800px;
            margin-bottom: 2rem;
            border: 2px solid #4b5563;
        }
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .header h1 {
            font-family: 'Oswald', sans-serif;
            font-size: 2.75rem;
            font-weight: 700;
            color: #90cdf4;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            letter-spacing: 1px;
            line-height: 1.2;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .stat-card {
            background-color: #374151;
            padding: 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
            border: 2px solid #63b3ed;
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        .stat-card h2 {
            font-family: 'Oswald', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            color: #a0aec0;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .stat-card p {
            font-family: 'Oswald', sans-serif;
            font-size: 3rem;
            font-weight: 700;
            color: #e2e8f0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        .level-progress-container {
            background-color: #1f2937;
            border-radius: 0.375rem;
            overflow: hidden;
            height: 2.25rem;
            margin-bottom: 2rem;
            border: 1px solid #4b5563;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }
        .level-progress-bar {
            background: linear-gradient(to right, #4299e1, #2b6cb0);
            height: 100%;
            width: 0%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Oswald', sans-serif;
            font-weight: 500;
            font-size: 0.9rem;
            color: white;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.4);
            transition: width 0.5s ease-in-out;
        }
        .controls-section h3, .perks-section h3 {
            font-family: 'Oswald', sans-serif;
            font-size: 1.4rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1.25rem;
            color: #e2e8f0;
            border-left: 5px solid #63b3ed;
            border-bottom: none;
            background-color: #374151;
            padding: 0.6rem 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-radius: 0.25rem 0.25rem 0 0;
        }
        .perks-section h4 {
            font-family: 'Oswald', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: #90cdf4;
            letter-spacing: 0.3px;
        }
        .perk-cost-display {
            font-family: 'Roboto', sans-serif;
            font-size: 0.875rem;
            font-weight: 400;
            color: #a0aec0;
        }

        /* Button Group Layouts */
        .controls-section .button-group { /* Level controls remain flex */
             display: flex;
             flex-wrap: wrap;
             gap: 0.75rem;
             justify-content: center; /* Center level buttons */
        }
        .perks-section .button-group { /* Perk buttons use grid */
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); /* Responsive grid */
            gap: 0.75rem;
        }

        .btn {
            padding: 0.6rem 0.8rem; /* Adjusted padding slightly */
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease, opacity 0.2s ease, box-shadow 0.2s ease;
            border: 1px solid transparent;
            /* min-width removed, grid handles width */
            text-align: center;
            font-size: 0.75rem;
            line-height: 1.2;
            box-shadow: 0 2px 3px rgba(0,0,0,0.15);
            /* Ensure buttons fill grid cell height if text wraps */
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 50px; /* Give buttons a minimum height */
        }
        .btn:hover:not(:disabled):not(.purchased) {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        .btn:active:not(:disabled):not(.purchased) {
            transform: translateY(0px);
            box-shadow: 0 1px 2px rgba(0,0,0,0.15);
        }

        /* Level Management Buttons */
        .btn-level, .btn-level-down, .btn-reset, .btn-max-level {
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 0.75rem 1.5rem;
            box-shadow: 0 3px 5px rgba(0,0,0,0.25), inset 0 -2px 0px rgba(0,0,0,0.15);
            min-height: auto; /* Override min-height for these */
            flex-grow: 1; /* Allow them to grow in flex container */
        }
        .btn-level { background-color: #38a169; color: white; border-color: #2f855a;}
        .btn-level:hover:not(:disabled) { background-color: #2f855a; box-shadow: 0 2px 3px rgba(0,0,0,0.2), inset 0 -1px 0px rgba(0,0,0,0.1);}
        .btn-level-down { background-color: #e53e3e; color: white; border-color: #c53030;}
        .btn-level-down:hover:not(:disabled) { background-color: #c53030; box-shadow: 0 2px 3px rgba(0,0,0,0.2), inset 0 -1px 0px rgba(0,0,0,0.1);}
        .btn-reset { background-color: #f59e0b; color: white; border-color: #d97706;}
        .btn-reset:hover:not(:disabled) { background-color: #d97706; box-shadow: 0 2px 3px rgba(0,0,0,0.2), inset 0 -1px 0px rgba(0,0,0,0.1);}
        .btn-max-level { background-color: #8b5cf6; color: white; border-color: #7c3aed;}
        .btn-max-level:hover:not(:disabled) { background-color: #7c3aed; box-shadow: 0 2px 3px rgba(0,0,0,0.2), inset 0 -1px 0px rgba(0,0,0,0.1);}

        /* Generic Perk Button Style (Orange) */
        .btn-perk { background-color: #dd6b20; color: white; border-color: #c05621;}
        .btn-perk:hover:not(:disabled):not(.purchased) { background-color: #c05621; }

        /* --- Skill Tree Specific Colors --- */
        .btn-perk-ceo { background-color: #FFD700; color: #4A3B00; border-color: #DAA520;}
        .btn-perk-ceo:hover:not(:disabled):not(.purchased) { background-color: #E6C300; }
        .btn-perk-program-builder { background-color: #C0C0C0; color: #363636; border-color: #A8A8A8;}
        .btn-perk-program-builder:hover:not(:disabled):not(.purchased) { background-color: #B0B0B0; }
        .btn-perk-motivator { background-color: #FFFF00; color: #5C5C00; border-color: #DADA00;}
        .btn-perk-motivator:hover:not(:disabled):not(.purchased) { background-color: #EAEA00; }
        .btn-perk-architect { background-color: #800080; color: white; border-color: #6A006A;}
        .btn-perk-architect:hover:not(:disabled):not(.purchased) { background-color: #6A006A; }
        .btn-perk-tactician { background-color: #007bff; color: white; border-color: #0069D9;} /* Blue */
        .btn-perk-tactician:hover:not(:disabled):not(.purchased) { background-color: #0069D9; }
        .btn-perk-strategist { background-color: #F97316; color: white; border-color: #EA580C;}
        .btn-perk-strategist:hover:not(:disabled):not(.purchased) { background-color: #EA580C; }
        .btn-perk-recruiter { background-color: #DC143C; color: white; border-color: #B21030;}
        .btn-perk-recruiter:hover:not(:disabled):not(.purchased) { background-color: #B21030; }
        .btn-perk-talent-developer { background-color: #006400; color: white; border-color: #004D00;}
        .btn-perk-talent-developer:hover:not(:disabled):not(.purchased) { background-color: #004D00; }

        /* Style for PURCHASED specific perks - Green Glow */
        .btn.purchased {
            background-color: #22543d !important;
            color: #c6f6d5 !important;
            cursor: pointer;
            box-shadow: 0 0 8px 3px #4ade80, inset 0 0 3px rgba(200, 255, 200, 0.3);
            border: 1px solid #34d399 !important;
            opacity: 1;
            transform: none;
        }
        .btn.purchased:hover {
            background-color: #1e4d36 !important;
            color: #c6f6d5 !important;
            box-shadow: 0 0 10px 4px #4ade80, inset 0 0 4px rgba(200, 255, 200, 0.4);
            transform: none;
        }

        /* General disabled style for buttons */
        .btn:disabled:not(.purchased) {
            background-color: #4a5568;
            color: #a0aec0;
            cursor: not-allowed;
            transform: none;
            opacity: 0.6;
            box-shadow: none;
            border-color: #3b4454;
        }

        .message-box {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: 0.375rem;
            text-align: center;
            font-weight: 500;
            display: none;
            border-width: 2px;
            border-style: solid;
        }
        .message-box-error {
            background-color: #fed7d7; color: #c53030; border-color: #f56565;
        }
        .message-box-success {
            background-color: #c6f6d5; color: #2f855a; border-color: #68d391;
        }

        @media (max-width: 640px) {
            .container { padding: 1.5rem; max-width: 100%;}
            .header h1 { font-size: 2rem; }
            .stats-grid { grid-template-columns: 1fr; }
            .stat-card p { font-size: 2.5rem; }
            .controls-section .button-group { flex-direction: column; } /* Keep controls stacked */
            .controls-section .button-group .btn { width: 100%; }
            .perks-section .button-group { grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); } /* Adjust grid for mobile */
            .btn { font-size: 0.7rem; padding: 0.5rem 0.7rem; min-height: 45px;}
            .controls-section h3, .perks-section h3 { font-size: 1.2rem; }
            .perks-section h4 { font-size: 0.9rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>CFB 25 Coach Points Tracker</h1>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <h2>Current Level</h2>
                <p id="currentLevelDisplay">1</p>
            </div>
            <div class="stat-card">
                <h2>Coach Points</h2>
                <p id="coachPointsDisplay">0</p> </div>
        </div>

        <div>
            <h3 id="levelProgressTitle" class="text-lg font-medium mb-1 text-blue-300" style="font-family: 'Oswald', sans-serif; color: #90cdf4;">Level Progress (1 to 50)</h3>
            <div class="level-progress-container">
                <div id="levelProgressBar" class="level-progress-bar">Level 1</div>
            </div>
        </div>

        <div class="controls-section">
            <h3>Level Management</h3>
            <div class="button-group">
                <button id="levelUpBtn" class="btn btn-level">Level Up (+10 Pts)</button>
                <button id="levelDownBtn" class="btn btn-level-down">Level Down (-10 Pts)</button>
                <button id="maxLevelBtn" class="btn btn-max-level">Max Out Level (to 50)</button>
                <button id="resetBtn" class="btn btn-reset">Reset All</button>
            </div>
        </div>

        <div class="perks-section">
            <h3>Generic Perk Purchases</h3>
            <div class="button-group" id="genericPerkButtonsContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Tree - CEO</h3>
            <div class="button-group" id="ceoMainPerkContainer"></div>
            <h4>CEO Sub-Skills <span class="perk-cost-display">(18 Pts each)</span></h4>
            <div class="button-group" id="ceoSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Tree - Program Builder</h3>
            <div class="button-group" id="programBuilderMainPerkContainer"></div>
            <h4>Program Builder Sub-Skills <span class="perk-cost-display">(12 Pts each)</span></h4>
            <div class="button-group" id="programBuilderSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Tree - Motivator</h3>
            <div class="button-group" id="motivatorMainPerkContainer"></div>
            <h4>Motivator Sub-Skills <span class="perk-cost-display">(5 Pts each, per position)</span></h4>
            <div class="button-group" id="motivatorSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Tree - Master Motivator</h3>
            <div class="button-group" id="masterMotivatorMainPerkContainer"></div>
            <h4>Master Motivator Sub-Skills <span class="perk-cost-display">(8 Pts each, per position)</span></h4>
            <div class="button-group" id="masterMotivatorSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Tree - Architect</h3>
            <h4>Architect Sub-Skills <span class="perk-cost-display">(8 Pts each, per position)</span></h4>
            <div class="button-group" id="architectSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Tree - Tactician</h3>
            <div class="button-group" id="tacticianMainPerkContainer"></div>
            <h4>Tactician Sub-Skills <span class="perk-cost-display">(5 Pts each)</span></h4>
            <div class="button-group" id="tacticianSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Tree - Tactician Master Class</h3>
            <div class="button-group" id="schemeGuruMainPerkContainer"> </div>
            <h4>Scheme Guru Sub-Skills <span class="perk-cost-display">(8 Pts each)</span></h4>
            <div class="button-group" id="schemeGuruSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Class - Recruiter</h3>
            <div class="button-group" id="recruiterMainPerkContainer"></div>
            <h4>Recruiter Sub-Skills <span class="perk-cost-display">(5 Pts each, per position)</span></h4>
            <div class="button-group" id="recruiterSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Masterclass - Expert Recruiter</h3>
            <div class="button-group" id="expertRecruiterMainPerkContainer"></div>
            <h4>Expert Recruiter Sub-Skills <span class="perk-cost-display">(8 Pts each, per position)</span></h4>
            <div class="button-group" id="expertRecruiterSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Tree - Strategist</h3>
            <h4>Strategist Sub-Skills <span class="perk-cost-display">(8 Pts each, per position)</span></h4>
            <div class="button-group" id="strategistSubPerksContainer"></div>
        </div>

        <div class="perks-section">
            <h3>Skill Tree - Talent Developer</h3>
            <h4>Talent Developer Sub-Skills <span class="perk-cost-display">(8 Pts each, per position)</span></h4>
            <div class="button-group" id="talentDeveloperSubPerksContainer"></div>
        </div>

        <div id="messageBox" class="message-box"></div>
    </div>

    <script>
        // --- Configuration ---
        const STARTING_LEVEL = 1;
        const MAX_LEVEL = 50;
        const POINTS_PER_LEVEL = 10;
        const STARTING_POINTS = 0; // Changed from 10 to 0
        const GENERIC_PERK_COSTS = [30, 20, 18, 15, 12, 8, 5];
        const POSITIONS = ["QB", "RB", "WR/TE", "OL", "DL", "LB", "DB", "K/P"];

        // --- State Variables ---
        let currentLevel = STARTING_LEVEL;
        let coachPoints = STARTING_POINTS;

        // Helper function to create leveled perks
        function createLeveledPerks(baseName, levels, cost, sectionId, colorClass) {
            let perks = [];
            for (let i = 1; i <= levels; i++) {
                perks.push({
                    id: `${baseName.toLowerCase().replace(/\s+/g, '_').replace(/\//g, '')}_l${i}`,
                    name: `${baseName} L${i}`,
                    cost: cost,
                    purchased: false,
                    sectionId: sectionId,
                    colorClass: colorClass
                });
            }
            return perks;
        }

        // Helper function to create positional perks
        function createPositionalPerks(baseName, cost, sectionId, positionsArray, colorClass) {
            return positionsArray.flatMap(pos => ({
                id: `${baseName.toLowerCase().replace(/\s+/g, '_').replace(/\//g, '').replace(/'/g, '')}_${pos.toLowerCase().replace('/', '')}`,
                name: `${baseName} (${pos})`,
                cost: cost,
                purchased: false,
                sectionId: sectionId,
                colorClass: colorClass
            }));
        }

        let specificPerks = [
             // CEO Tree - Gold
            { id: 'ceo_tree', name: 'Skill Tree - CEO', cost: 30, purchased: false, sectionId: 'ceoMainPerkContainer', colorClass: 'btn-perk-ceo' },
            { id: 'delay_sunday', name: 'Delay Sunday', cost: 18, purchased: false, sectionId: 'ceoSubPerksContainer', colorClass: 'btn-perk-ceo' },
            { id: 'second_chance', name: 'Second Chance Keeper', cost: 18, purchased: false, sectionId: 'ceoSubPerksContainer', colorClass: 'btn-perk-ceo' },
            { id: 'home_away', name: 'Home Away from Home', cost: 18, purchased: false, sectionId: 'ceoSubPerksContainer', colorClass: 'btn-perk-ceo' },
            { id: 'portal_preview', name: 'Portal Preview', cost: 18, purchased: false, sectionId: 'ceoSubPerksContainer', colorClass: 'btn-perk-ceo' },
            { id: 'gasoline', name: 'Gasoline', cost: 18, purchased: false, sectionId: 'ceoSubPerksContainer', colorClass: 'btn-perk-ceo' },
            { id: 'hot_seat', name: 'Hot Seat Chiller', cost: 18, purchased: false, sectionId: 'ceoSubPerksContainer', colorClass: 'btn-perk-ceo' },
            { id: 'dream_school', name: 'Dream School', cost: 18, purchased: false, sectionId: 'ceoSubPerksContainer', colorClass: 'btn-perk-ceo' },
            { id: 'bundle_discount_ceo', name: 'Bundle Discount', cost: 18, purchased: false, sectionId: 'ceoSubPerksContainer', colorClass: 'btn-perk-ceo' },

            // Program Builder Tree - Silver
            { id: 'program_builder_tree', name: 'Skill Tree - Program Builder', cost: 20, purchased: false, sectionId: 'programBuilderMainPerkContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'booster_packed', name: 'Booster Packed', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'tack_one_on', name: 'Tack One On', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'lower_the_bar', name: 'Lower the Bar', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'home_field_advantage', name: 'Home Field Advantage', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'road_warriors', name: 'Road Warriors', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'not_intimidated', name: 'Not Intimidated', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'best_advice', name: 'Best Advice', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'family_atmosphere', name: 'Family Atmosphere', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'lets_run_it_back', name: 'Lets Run It Back', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'gift_of_gab', name: 'Gift of Gab', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'roster_retainer', name: 'Roster Retainer', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'full_refund', name: 'Full Refund', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'giving_back', name: 'Giving Back', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'household_name', name: 'Household Name', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'hometown_discount', name: 'Hometown Discount', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'invest', name: 'Invest', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'making_inroads', name: 'Making Inroads', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'share_the_wealth', name: 'Share the Wealth', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'smart_goals', name: 'Smart Goals', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'signing_bonus', name: 'Signing Bonus', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },
            { id: 'friends_family_discount', name: 'Friends & Family Discount', cost: 12, purchased: false, sectionId: 'programBuilderSubPerksContainer', colorClass: 'btn-perk-program-builder' },

            // Motivator Tree - Yellow
            { id: 'motivator_tree', name: 'Skill Tree - Motivator', cost: 10, purchased: false, sectionId: 'motivatorMainPerkContainer', colorClass: 'btn-perk-motivator' },
            ...createPositionalPerks("Pay it forward", 5, 'motivatorSubPerksContainer', POSITIONS, 'btn-perk-motivator'),
            ...createPositionalPerks("Hot hand", 5, 'motivatorSubPerksContainer', POSITIONS, 'btn-perk-motivator'),
            ...createPositionalPerks("Put in work", 5, 'motivatorSubPerksContainer', POSITIONS, 'btn-perk-motivator'),
            ...createPositionalPerks("Locked in", 5, 'motivatorSubPerksContainer', POSITIONS, 'btn-perk-motivator'),

            // Master Motivator Tree - Yellow
            { id: 'master_motivator_tree', name: 'Skill Tree - Master Motivator', cost: 15, purchased: false, sectionId: 'masterMotivatorMainPerkContainer', colorClass: 'btn-perk-motivator' },
            ...createPositionalPerks("Quick recovery", 8, 'masterMotivatorSubPerksContainer', POSITIONS, 'btn-perk-motivator'),
            ...createPositionalPerks("Extra gear", 8, 'masterMotivatorSubPerksContainer', POSITIONS, 'btn-perk-motivator'),
            ...createPositionalPerks("Everybody eats", 8, 'masterMotivatorSubPerksContainer', POSITIONS, 'btn-perk-motivator'),
            ...createPositionalPerks("Icy veins", 8, 'masterMotivatorSubPerksContainer', POSITIONS, 'btn-perk-motivator'),

            // Architect Tree - Purple
            ...createPositionalPerks("Field Study", 8, 'architectSubPerksContainer', POSITIONS, 'btn-perk-architect'),
            ...createPositionalPerks("Limitless", 8, 'architectSubPerksContainer', POSITIONS, 'btn-perk-architect'),
            ...createPositionalPerks("Cant stop, wont stop", 8, 'architectSubPerksContainer', POSITIONS, 'btn-perk-architect'),
            ...createPositionalPerks("Put a ring on it", 8, 'architectSubPerksContainer', POSITIONS, 'btn-perk-architect'),

            // Tactician Tree - Blue
            { id: 'tactician_tree', name: 'Tactician', cost: 10, purchased: false, sectionId: 'tacticianMainPerkContainer', colorClass: 'btn-perk-tactician' },
            { id: 'mobile_qb_assist', name: 'Mobile QB Assist', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'passing_qb_ratings_boost', name: 'Passing QB Ratings Boost', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'mobile_qb_ratings_boost_2', name: 'Mobile QB Ratings Boost 2', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'passing_qb_ratings_boost_2', name: 'Passing QB Ratings Boost 2', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            ...createLeveledPerks("RB Ratings Boost", 4, 5, 'tacticianSubPerksContainer', 'btn-perk-tactician'),
            ...createLeveledPerks("WR/TE Ratings Boost", 4, 5, 'tacticianSubPerksContainer', 'btn-perk-tactician'),
            { id: 'pass_blocking_ol_ratings_boost', name: 'Pass Blocking OL Ratings Boost', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'run_blocking_ol_ratings_boost', name: 'Run Blocking OL Ratings Boost', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'finesse_ol_ratings_boost', name: 'Finesse OL Ratings Boost', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'power_ol_ratings_boost', name: 'Power OL Ratings Boost', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'cross_train_ol_dl', name: 'Cross Train OL as DL', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'cross_train_dl_ol', name: 'Cross Train DL as OL', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'cross_train_wr_db', name: 'Cross Train WR as DB', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'cross_train_db_wr', name: 'Cross Train DB as WR', cost: 5, purchased: false, sectionId: 'tacticianSubPerksContainer', colorClass: 'btn-perk-tactician' },
            ...createLeveledPerks("DB Ratings Boost", 4, 5, 'tacticianSubPerksContainer', 'btn-perk-tactician'),
            ...createLeveledPerks("LB Ratings Boost", 4, 5, 'tacticianSubPerksContainer', 'btn-perk-tactician'),
            ...createLeveledPerks("DL Ratings Boost", 4, 5, 'tacticianSubPerksContainer', 'btn-perk-tactician'),

            // Tactician Master Class - Scheme Guru Tree - Blue
            { id: 'scheme_guru_tree', name: 'Scheme Guru', cost: 15, purchased: false, sectionId: 'schemeGuruMainPerkContainer', colorClass: 'btn-perk-tactician' },
            { id: 'battery_pack', name: 'Battery Pack', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'caught_napping', name: 'Caught Napping', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'on_their_heels', name: 'On Their Heels', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'tipped_your_hand', name: 'Tipped Your Hand', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'take_whats_there', name: 'Take Whats There', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'chew_up_yards', name: 'Chew Up Yards', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'stretch_the_field', name: 'Stretch the Field', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'we_see_you', name: 'We See You', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'wear_em_down', name: 'Wear em Down', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'demoralizing', name: 'Demoralizing', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'keep_blocks_longer', name: 'Keep Blocks Longer', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'to_the_whistle', name: 'To The Whistle', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'hater_blockers', name: 'Hater Blockers', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'teflon', name: 'Teflon', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'polished', name: 'Polished', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'clean_sheet_offense', name: 'Clean Sheet Offense', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'unfriendly_confines', name: 'Unfriendly Confines', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'too_loud', name: 'Too Loud', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'no_free_yards', name: 'No Free Yards', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'clean_sheet_defense', name: 'Clean Sheet Defense', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'keep_em_coming', name: 'Keep em Coming', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'fresh_legs', name: 'Fresh Legs', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'hands_off', name: 'Hands Off', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'he_shed', name: 'He Shed', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'punchers_chance', name: 'Punchers Chance', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'no_mid_here', name: 'No Mid Here', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'nothing_deep', name: 'Nothing Deep', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'master_of_disguise', name: 'Master of Disguise', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'gas_tank', name: 'Gas Tank', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'not_so_fast', name: 'Not So Fast', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'cardio_kings', name: 'Cardio Kings', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },
            { id: 'camoflogued_coverage', name: 'Camoflogued Coverage', cost: 8, purchased: false, sectionId: 'schemeGuruSubPerksContainer', colorClass: 'btn-perk-tactician' },

            // Recruiter Skill Class - Red
            { id: 'recruiter_skill_class', name: 'Skill Class - Recruiter', cost: 10, purchased: false, sectionId: 'recruiterMainPerkContainer', colorClass: 'btn-perk-recruiter' },
            ...createPositionalPerks("Advanced Look", 5, 'recruiterSubPerksContainer', POSITIONS, 'btn-perk-recruiter'),
            ...createPositionalPerks("Most Influential", 5, 'recruiterSubPerksContainer', POSITIONS, 'btn-perk-recruiter'),
            ...createPositionalPerks("Always be Crootin'", 5, 'recruiterSubPerksContainer', POSITIONS, 'btn-perk-recruiter'),
            ...createPositionalPerks("Magnetic Personality", 5, 'recruiterSubPerksContainer', POSITIONS, 'btn-perk-recruiter'),

            // Expert Recruiter Skill Masterclass - Red
            { id: 'expert_recruiter_masterclass', name: 'Skill Masterclass - Expert Recruiter', cost: 15, purchased: false, sectionId: 'expertRecruiterMainPerkContainer', colorClass: 'btn-perk-recruiter' },
            ...createPositionalPerks("Lasting Impression", 8, 'expertRecruiterSubPerksContainer', POSITIONS, 'btn-perk-recruiter'),
            ...createPositionalPerks("Upsell", 8, 'expertRecruiterSubPerksContainer', POSITIONS, 'btn-perk-recruiter'),
            ...createPositionalPerks("Home Sweet Home", 8, 'expertRecruiterSubPerksContainer', POSITIONS, 'btn-perk-recruiter'),
            ...createPositionalPerks("Ideal Situation", 8, 'expertRecruiterSubPerksContainer', POSITIONS, 'btn-perk-recruiter'),

            // Strategist Skill Tree - Orange
            ...createPositionalPerks("Making friends", 8, 'strategistSubPerksContainer', POSITIONS, 'btn-perk-strategist'),
            ...createPositionalPerks("Hospitality", 8, 'strategistSubPerksContainer', POSITIONS, 'btn-perk-strategist'),
            ...createPositionalPerks("Last dance", 8, 'strategistSubPerksContainer', POSITIONS, 'btn-perk-strategist'),
            ...createPositionalPerks("Mind reader", 8, 'strategistSubPerksContainer', POSITIONS, 'btn-perk-strategist'),

            // Talent Developer Skill Tree - Dark Green
            ...createPositionalPerks("Portal King", 8, 'talentDeveloperSubPerksContainer', POSITIONS, 'btn-perk-talent-developer'),
            ...createPositionalPerks("Reach your potential", 8, 'talentDeveloperSubPerksContainer', POSITIONS, 'btn-perk-talent-developer'),
            ...createPositionalPerks("QB whisperer", 8, 'talentDeveloperSubPerksContainer', POSITIONS, 'btn-perk-talent-developer'),
            ...createPositionalPerks("Star Maker", 8, 'talentDeveloperSubPerksContainer', POSITIONS, 'btn-perk-talent-developer')
        ];

        // --- DOM Elements ---
        const currentLevelDisplay = document.getElementById('currentLevelDisplay');
        const coachPointsDisplay = document.getElementById('coachPointsDisplay');
        const levelProgressBar = document.getElementById('levelProgressBar');
        const levelProgressTitle = document.getElementById('levelProgressTitle');
        const levelUpBtn = document.getElementById('levelUpBtn');
        const levelDownBtn = document.getElementById('levelDownBtn');
        const maxLevelBtn = document.getElementById('maxLevelBtn');
        const resetBtn = document.getElementById('resetBtn');
        const genericPerkButtonsContainer = document.getElementById('genericPerkButtonsContainer');
        const messageBox = document.getElementById('messageBox');

        // --- Functions ---
        function updateDisplay() {
            currentLevelDisplay.textContent = currentLevel;
            coachPointsDisplay.textContent = coachPoints;

            let progressPercentage = 0;
            if (MAX_LEVEL > STARTING_LEVEL) {
                 progressPercentage = ((currentLevel - STARTING_LEVEL) / (MAX_LEVEL - STARTING_LEVEL)) * 100;
            } else if (currentLevel >= MAX_LEVEL) {
                progressPercentage = 100;
            }

            levelProgressBar.style.width = `${Math.max(0, Math.min(100, progressPercentage))}%`;
            levelProgressBar.textContent = `Level ${currentLevel}`;

            levelUpBtn.disabled = currentLevel >= MAX_LEVEL;
            levelDownBtn.disabled = currentLevel <= STARTING_LEVEL;
            maxLevelBtn.disabled = currentLevel >= MAX_LEVEL;

            document.querySelectorAll('#genericPerkButtonsContainer .btn-perk').forEach(button => {
                const cost = parseInt(button.dataset.cost);
                button.disabled = coachPoints < cost;
            });

            specificPerks.forEach(perk => {
                const button = document.querySelector(`.btn[data-perk-id='${perk.id}']`);
                if (button) {
                    const canAfford = coachPoints >= perk.cost;
                    // Button is disabled if it's NOT purchased AND cannot be afforded.
                    button.disabled = !perk.purchased && !canAfford;

                    if (perk.purchased) {
                        button.classList.add('purchased');
                        button.textContent = `${perk.name} (Purchased)`;
                    } else {
                        button.classList.remove('purchased');
                        button.textContent = `${perk.name} (${perk.cost} Pts)`;
                    }
                }
            });
        }

        function showMessage(message, type = 'success') {
            messageBox.textContent = message;
            messageBox.className = `message-box ${type === 'error' ? 'message-box-error' : 'message-box-success'}`;
            messageBox.style.display = 'block';
            setTimeout(() => { messageBox.style.display = 'none'; }, 3000);
        }

        function handleLevelUp() {
            if (currentLevel < MAX_LEVEL) {
                currentLevel++;
                coachPoints += POINTS_PER_LEVEL;
                updateDisplay();
                showMessage(`Leveled up to ${currentLevel}! Gained ${POINTS_PER_LEVEL} points.`);
            } else {
                showMessage('Already at max level!', 'error');
            }
        }

        function handleLevelDown() {
            if (currentLevel > STARTING_LEVEL) {
                currentLevel--;
                coachPoints -= POINTS_PER_LEVEL;
                if (coachPoints < 0) coachPoints = 0; // Ensure points don't go negative
                updateDisplay();
                showMessage(`Leveled down to ${currentLevel}. Lost ${POINTS_PER_LEVEL} points.`);
            } else {
                showMessage(`Already at starting level (Level ${STARTING_LEVEL})!`, 'error');
            }
        }

        function handleGenericPerkPurchase(cost) {
            if (coachPoints >= cost) {
                coachPoints -= cost;
                updateDisplay();
                showMessage(`Generic perk purchased for ${cost} points.`);
            } else {
                showMessage('Not enough coach points for this generic perk!', 'error');
            }
        }

        function handleSpecificPerkPurchase(perkId) {
            const perk = specificPerks.find(p => p.id === perkId);
            if (!perk) {
                showMessage('Error: Perk not found! ID: ' + perkId, 'error');
                console.error("Perk not found with ID:", perkId);
                return;
            }

            if (perk.purchased) {
                // Unselect (refund)
                coachPoints += perk.cost;
                perk.purchased = false;
                updateDisplay();
                showMessage(`${perk.name} unselected. ${perk.cost} points refunded.`, 'success');
            } else {
                // Purchase
                if (coachPoints >= perk.cost) {
                    coachPoints -= perk.cost;
                    perk.purchased = true;
                    updateDisplay();
                    showMessage(`${perk.name} purchased for ${perk.cost} points.`, 'success');
                } else {
                    showMessage(`Not enough coach points for ${perk.name}! (Need ${perk.cost})`, 'error');
                }
            }
        }

        function handleMaxOutLevel() {
            if (currentLevel < MAX_LEVEL) {
                const levelsToGain = MAX_LEVEL - currentLevel;
                const pointsGained = levelsToGain * POINTS_PER_LEVEL;
                coachPoints += pointsGained;
                currentLevel = MAX_LEVEL;
                updateDisplay();
                showMessage(`Maxed out to Level ${MAX_LEVEL}! Gained ${pointsGained} points.`);
            } else {
                showMessage('Already at max level!', 'error');
            }
        }

        function handleReset() {
            currentLevel = STARTING_LEVEL;
            coachPoints = STARTING_POINTS; // This will now reset to 0
            specificPerks.forEach(perk => {
                perk.purchased = false;
            });
            updateDisplay();
            showMessage('Tracker has been reset to starting values.');
        }

        function createGenericPerkButtons() {
            genericPerkButtonsContainer.innerHTML = '';
            GENERIC_PERK_COSTS.sort((a, b) => a - b).forEach(cost => {
                const button = document.createElement('button');
                button.classList.add('btn', 'btn-perk');
                button.textContent = `Buy Perk (${cost} Pts)`;
                button.dataset.cost = cost;
                button.addEventListener('click', () => handleGenericPerkPurchase(cost));
                genericPerkButtonsContainer.appendChild(button);
            });
        }

        function createSpecificPerkButtons() {
            const perkContainerIds = ['ceoMainPerkContainer', 'ceoSubPerksContainer',
                                    'programBuilderMainPerkContainer', 'programBuilderSubPerksContainer',
                                    'motivatorMainPerkContainer', 'motivatorSubPerksContainer',
                                    'masterMotivatorMainPerkContainer', 'masterMotivatorSubPerksContainer',
                                    'architectSubPerksContainer',
                                    'tacticianMainPerkContainer',
                                    'tacticianSubPerksContainer',
                                    'schemeGuruMainPerkContainer',
                                    'schemeGuruSubPerksContainer',
                                    'recruiterMainPerkContainer',
                                    'recruiterSubPerksContainer',
                                    'expertRecruiterMainPerkContainer',
                                    'expertRecruiterSubPerksContainer',
                                    'strategistSubPerksContainer',
                                    'talentDeveloperSubPerksContainer'
                                    ];
            perkContainerIds.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerHTML = '';
            });

            specificPerks.forEach(perk => {
                const container = document.getElementById(perk.sectionId);
                if (!container) {
                    console.warn(`Container with id ${perk.sectionId} not found for perk ${perk.name}`);
                    return;
                }
                const button = document.createElement('button');
                button.classList.add('btn');
                if (perk.colorClass) {
                    button.classList.add(perk.colorClass);
                } else {
                    button.classList.add('btn-perk');
                }
                button.textContent = `${perk.name} (${perk.cost} Pts)`;
                button.dataset.perkId = perk.id;
                button.addEventListener('click', () => handleSpecificPerkPurchase(perk.id));
                container.appendChild(button);
            });
        }

        // --- Event Listeners ---
        levelUpBtn.addEventListener('click', handleLevelUp);
        levelDownBtn.addEventListener('click', handleLevelDown);
        maxLevelBtn.addEventListener('click', handleMaxOutLevel);
        resetBtn.addEventListener('click', handleReset);

        // --- Initialization ---
        function initializeApp() {
            // Set initial display based on STARTING_POINTS
            currentLevelDisplay.textContent = STARTING_LEVEL;
            coachPointsDisplay.textContent = STARTING_POINTS; // Will be 0
            levelProgressBar.textContent = `Level ${STARTING_LEVEL}`;

            createGenericPerkButtons();
            createSpecificPerkButtons();
            updateDisplay(); // Call updateDisplay to correctly set button states based on 0 points
        }

        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>

